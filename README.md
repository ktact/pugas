# pugas
PUGAS is a toy assembler, not pug ass.

## 開発方針
1. 実装する機能を満たす必要最低限のアセンブリコードを用意する
  ```bash
  cat asm.s
  .intel_syntax noprefix
  .text
  .global main
  main:
    mov rax, 42
    ret
  ```

2. 用意したアセンブリコードを`as`でアセンブルし、これと同じバイナリを吐くプログラムを作成する
  * バイト列は下記のように確認できる
    ```bash
    as -o expected.o asm.s
    hexdump -Cv expected.o
    00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|
    00000010  01 00 3e 00 01 00 00 00  00 00 00 00 00 00 00 00  |..>.............|
    00000020  00 00 00 00 00 00 00 00  f8 00 00 00 00 00 00 00  |................|
    00000030  00 00 00 00 40 00 00 00  00 00 40 00 07 00 06 00  |....@.....@.....|
    00000040  48 c7 c0 2a 00 00 00 c3  00 00 00 00 00 00 00 00  |H..*............|
    00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000060  00 00 00 00 03 00 01 00  00 00 00 00 00 00 00 00  |................|
    00000070  00 00 00 00 00 00 00 00  00 00 00 00 03 00 02 00  |................|
    00000080  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000090  00 00 00 00 03 00 03 00  00 00 00 00 00 00 00 00  |................|
    000000a0  00 00 00 00 00 00 00 00  01 00 00 00 10 00 01 00  |................|
    000000b0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000000c0  00 6d 61 69 6e 00 00 2e  73 79 6d 74 61 62 00 2e  |.main...symtab..|
    000000d0  73 74 72 74 61 62 00 2e  73 68 73 74 72 74 61 62  |strtab..shstrtab|
    000000e0  00 2e 74 65 78 74 00 2e  64 61 74 61 00 2e 62 73  |..text..data..bs|
    000000f0  73 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |s...............|
    00000100  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000110  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000120  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000130  00 00 00 00 00 00 00 00  1b 00 00 00 01 00 00 00  |................|
    00000140  06 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000150  40 00 00 00 00 00 00 00  08 00 00 00 00 00 00 00  |@...............|
    00000160  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|
    00000170  00 00 00 00 00 00 00 00  21 00 00 00 01 00 00 00  |........!.......|
    00000180  03 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000190  48 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |H...............|
    000001a0  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|
    000001b0  00 00 00 00 00 00 00 00  27 00 00 00 08 00 00 00  |........'.......|
    000001c0  03 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    000001d0  48 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |H...............|
    000001e0  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|
    000001f0  00 00 00 00 00 00 00 00  01 00 00 00 02 00 00 00  |................|
    00000200  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000210  48 00 00 00 00 00 00 00  78 00 00 00 00 00 00 00  |H.......x.......|
    00000220  05 00 00 00 04 00 00 00  08 00 00 00 00 00 00 00  |................|
    00000230  18 00 00 00 00 00 00 00  09 00 00 00 03 00 00 00  |................|
    00000240  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000250  c0 00 00 00 00 00 00 00  06 00 00 00 00 00 00 00  |................|
    00000260  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|
    00000270  00 00 00 00 00 00 00 00  11 00 00 00 03 00 00 00  |................|
    00000280  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
    00000290  c6 00 00 00 00 00 00 00  2c 00 00 00 00 00 00 00  |........,.......|
    000002a0  00 00 00 00 00 00 00 00  01 00 00 00 00 00 00 00  |................|
    000002b0  00 00 00 00 00 00 00 00                           |........|        
    000002b8
    ```

3. 作成したプログラムが出力したバイナリと、用意したアセンブリコードから`as`が生成したバイナリを比較し一致することを確認する
  ```bash
  as -o expected.o asm.s
  ./pugas > actual.o
  cmp expected.o actual.o
  ```

  * 作成したプログラムが出力したバイナリを実行し、アセンブリコードに記述した通り42が返ることを確認
    ```bash
    gcc actual.o -o a.out
    echo $?
    42
    ```

